
        include 'gmdmequ.asm'

        SECTION V22B_PROM

        GLOBAL    IFCOE
        GLOBAL    MOD_TBL
        GLOBAL    SIN_TBL
        GLOBAL    absdat
        GLOBAL    tx_IQmap
        GLOBAL    tx_quadtab
        GLOBAL    cos2100

        org      x:

;SIN_TBL       dsm    256                 ;A 256 point sine table
                                          ;  (Base freq. = 28.125 Hz)
                                          ;  for generating guard tones of
                                          ;  1800 Hz and 562.5 Hz

SIN_TBL                                   ;Generate a 256 point sine table

        dc    0.000000
        dc    0.024541
        dc    0.049068
        dc    0.073565
        dc    0.098017
        dc    0.122411
        dc    0.146730
        dc    0.170962
        dc    0.195090
        dc    0.219101
        dc    0.242980
        dc    0.266713
        dc    0.290285
        dc    0.313682
        dc    0.336890
        dc    0.359895
        dc    0.382683
        dc    0.405241
        dc    0.427555
        dc    0.449611
        dc    0.471397
        dc    0.492898
        dc    0.514103
        dc    0.534998
        dc    0.555570
        dc    0.575808
        dc    0.595699
        dc    0.615232
        dc    0.634393
        dc    0.653173
        dc    0.671559
        dc    0.689541
        dc    0.707107
        dc    0.724247
        dc    0.740951
        dc    0.757209
        dc    0.773010
        dc    0.788346
        dc    0.803208
        dc    0.817585
        dc    0.831470
        dc    0.844854
        dc    0.857729
        dc    0.870087
        dc    0.881921
        dc    0.893224
        dc    0.903989
        dc    0.914210
        dc    0.923880
        dc    0.932993
        dc    0.941544
        dc    0.949528
        dc    0.956940
        dc    0.963776
        dc    0.970031
        dc    0.975702
        dc    0.980785
        dc    0.985278
        dc    0.989177
        dc    0.992480
        dc    0.995185
        dc    0.997290
        dc    0.998795
        dc    0.999699
        dc    0.999999
        dc    0.999699
        dc    0.998795
        dc    0.997290
        dc    0.995185
        dc    0.992480
        dc    0.989177
        dc    0.985278
        dc    0.980785
        dc    0.975702
        dc    0.970031
        dc    0.963776
        dc    0.956940
        dc    0.949528
        dc    0.941544
        dc    0.932993
        dc    0.923880
        dc    0.914210
        dc    0.903989
        dc    0.893224
        dc    0.881921
        dc    0.870087
        dc    0.857729
        dc    0.844854
        dc    0.831470
        dc    0.817585
        dc    0.803208
        dc    0.788346
        dc    0.773010
        dc    0.757209
        dc    0.740951
        dc    0.724247
        dc    0.707107
        dc    0.689541
        dc    0.671559
        dc    0.653173
        dc    0.634393
        dc    0.615232
        dc    0.595699
        dc    0.575808
        dc    0.555570
        dc    0.534998
        dc    0.514103
        dc    0.492898
        dc    0.471397
        dc    0.449611
        dc    0.427555
        dc    0.405241
        dc    0.382683
        dc    0.359895
        dc    0.336890
        dc    0.313682
        dc    0.290285
        dc    0.266713
        dc    0.242980
        dc    0.219101
        dc    0.195090
        dc    0.170962
        dc    0.146730
        dc    0.122411
        dc    0.098017
        dc    0.073565
        dc    0.049068
        dc    0.024541
        dc    0.000000
        dc    -0.024541
        dc    -0.049068
        dc    -0.073565
        dc    -0.098017
        dc    -0.122411
        dc    -0.146730
        dc    -0.170962
        dc    -0.195090
        dc    -0.219101
        dc    -0.242980
        dc    -0.266713
        dc    -0.290285
        dc    -0.313682
        dc    -0.336890
        dc    -0.359895
        dc    -0.382683
        dc    -0.405241
        dc    -0.427555
        dc    -0.449611
        dc    -0.471397
        dc    -0.492898
        dc    -0.514103
        dc    -0.534998
        dc    -0.555570
        dc    -0.575808
        dc    -0.595699
        dc    -0.615232
        dc    -0.634393
        dc    -0.653173
        dc    -0.671559
        dc    -0.689541
        dc    -0.707107
        dc    -0.724247
        dc    -0.740951
        dc    -0.757209
        dc    -0.773010
        dc    -0.788346
        dc    -0.803208
        dc    -0.817585
        dc    -0.831470
        dc    -0.844854
        dc    -0.857729
        dc    -0.870087
        dc    -0.881921
        dc    -0.893224
        dc    -0.903989
        dc    -0.914210
        dc    -0.923880
        dc    -0.932993
        dc    -0.941544
        dc    -0.949528
        dc    -0.956940
        dc    -0.963776
        dc    -0.970031
        dc    -0.975702
        dc    -0.980785
        dc    -0.985278
        dc    -0.989177
        dc    -0.992480
        dc    -0.995185
        dc    -0.997290
        dc    -0.998795
        dc    -0.999699
        dc    -1.000000
        dc    -0.999699
        dc    -0.998795
        dc    -0.997290
        dc    -0.995185
        dc    -0.992480
        dc    -0.989177
        dc    -0.985278
        dc    -0.980785
        dc    -0.975702
        dc    -0.970031
        dc    -0.963776
        dc    -0.956940
        dc    -0.949528
        dc    -0.941544
        dc    -0.932993
        dc    -0.923880
        dc    -0.914210
        dc    -0.903989
        dc    -0.893224
        dc    -0.881921
        dc    -0.870087
        dc    -0.857729
        dc    -0.844854
        dc    -0.831470
        dc    -0.817585
        dc    -0.803208
        dc    -0.788346
        dc    -0.773010
        dc    -0.757209
        dc    -0.740951
        dc    -0.724247
        dc    -0.707107
        dc    -0.689541
        dc    -0.671559
        dc    -0.653173
        dc    -0.634393
        dc    -0.615232
        dc    -0.595699
        dc    -0.575808
        dc    -0.555570
        dc    -0.534998
        dc    -0.514103
        dc    -0.492898
        dc    -0.471397
        dc    -0.449611
        dc    -0.427555
        dc    -0.405241
        dc    -0.382683
        dc    -0.359895
        dc    -0.336890
        dc    -0.313682
        dc    -0.290285
        dc    -0.266713
        dc    -0.242980
        dc    -0.219101
        dc    -0.195090
        dc    -0.170962
        dc    -0.146730
        dc    -0.122411
        dc    -0.098017
        dc    -0.073565
        dc    -0.049068
        dc    -0.024541

        

;cos2100       dsm    24                  ;Cosine table for gen. answering
                                          ;  tone
cos2100                                   ;Generate a 2100 Hz (answering 
                                          ;  tone) table of 24 values  
        dc    0.250000
        dc    -0.064705
        dc    -0.216506
        dc    0.176777
        dc    0.125000
        dc    -0.241481
        dc    -0.000000
        dc    0.241481
        dc    -0.125000
        dc    -0.176777
        dc    0.216506
        dc    0.064705
        dc    -0.250000
        dc    0.064705
        dc    0.216506
        dc    -0.176777
        dc    -0.125000
        dc    0.241481
        dc    -0.000000
        dc    -0.241481
        dc    0.125000
        dc    0.176777
        dc    -0.216506
        dc    -0.064705
        
;Dummy 'dc' s to align MOD_TBL at start of a modulo-12 buffer
        dc    0.0
        dc    0.0
        dc    0.0
        dc    0.0
        dc    0.0
        dc    0.0
        dc    0.0
        dc    0.0


;MOD_TBL       dsm       12  

MOD_TBL    

        dc    0.999999
        dc    -0.000000
        dc    0.500000
        dc    -0.866025
        dc    -0.5
        dc    -0.866025
        dc    -0.999999
        dc    -0.000000
        dc    -0.500000
        dc    0.866025
        dc    0.500000
        dc    0.866025
           
;------------------------
;rx_difdc initializations
;------------------------
absdat  dc      $0003,$000b,$0005,$0001
        dc      $0007,$000f,$000d,$0009
        dc      $000a,$000e,$000c,$0004
        dc      $0002,$0006,$0008,$0000

;---------------------
;tx_enc initializations
;----------------------
tx_quadtab      dc           2,0,3,1      ;Quadrant numbers initialized for
                dc           3,2,1,0      ;  module tx_enc
                dc           0,1,2,3      ;Levels of symbols I & Q for
                dc           1,3,0,2      ;  module tx_enc

tx_IQmap
        dc      $f000,$f000,$f000,$1000
        dc      $1000,$f000,$1000,$1000
        dc      $f000,$d000,$d000,$1000
        dc      $3000,$f000,$1000,$3000
        dc      $d000,$f000,$f000,$3000
        dc      $1000,$d000,$3000,$1000
        dc      $d000,$d000,$d000,$3000
        dc      $3000,$d000,$3000,$3000

IFCOE   dc (-0.17929077e-03)*64           ;Interpolation filter coefficients
        dc (-0.18683518e-03)*64
        dc (-0.19564945e-03)*64
        dc (-0.20200841e-03)*64
        dc (-0.21067110e-03)*64
        dc (-0.21673390e-03)*64
        dc (-0.22513093e-03)*64
        dc (-0.23092458e-03)*64
        dc (-0.23913442e-03)*64
        dc (-0.24408870e-03)*64
        dc (-0.25130971e-03)*64
        dc (-0.25503454e-03)*64
        dc (-0.26220339e-03)*64
        dc (-0.26293145e-03)*64
        dc (-0.27089473e-03)*64
        dc (-0.27615996e-03)*64
        dc (-0.27890503e-03)*64
        dc (-0.28174138e-03)*64
        dc (-0.28482592e-03)*64
        dc (-0.28694107e-03)*64
        dc (-0.28935506e-03)*64
        dc (-0.28991303e-03)*64
        dc (-0.29126275e-03)*64
        dc (-0.29091688e-03)*64
        dc (-0.29136043e-03)*64
        dc (-0.28945762e-03)*64
        dc (-0.28872211e-03)*64
        dc (-0.28566411e-03)*64
        dc (-0.28236257e-03)*64
        dc (-0.27888827e-03)*64
        dc (-0.27519045e-03)*64
        dc (-0.26963255e-03)*64
        dc (-0.26445673e-03)*64
        dc (-0.25743258e-03)*64
        dc (-0.25112520e-03)*64
        dc (-0.24277100e-03)*64
        dc (-0.23494277e-03)*64
        dc (-0.22512139e-03)*64
        dc (-0.21611038e-03)*64
        dc (-0.20509562e-03)*64
        dc (-0.19457191e-03)*64
        dc (-0.18258439e-03)*64
        dc (-0.17058989e-03)*64
        dc (-0.15672203e-03)*64
        dc (-0.14393427e-03)*64
        dc (-0.12899679e-03)*64
        dc (-0.11496432e-03)*64
        dc (-0.98748133e-04)*64
        dc (-0.83544524e-04)*64
        dc (-0.66371169e-04)*64
        dc (-0.50169881e-04)*64
        dc (-0.31900126e-04)*64
        dc (-0.14650170e-04)*64
        dc  (0.43550972e-05)*64
        dc  (0.22442779e-04)*64
        dc  (0.42241067e-04)*64
        dc  (0.60646795e-04)*64
        dc  (0.81272796e-04)*64
        dc  (0.10039308e-03)*64
        dc  (0.12133713e-03)*64
        dc  (0.14074100e-03)*64
        dc  (0.16191020e-03)*64
        dc  (0.18159347e-03)*64
        dc  (0.20287489e-03)*64
        dc  (0.22246526e-03)*64
        dc  (0.24357531e-03)*64
        dc  (0.26307558e-03)*64
        dc  (0.28397352e-03)*64
        dc  (0.30298880e-03)*64
        dc  (0.32356218e-03)*64
        dc  (0.34194300e-03)*64
        dc  (0.36165654e-03)*64
        dc  (0.37939660e-03)*64
        dc  (0.39830361e-03)*64
        dc  (0.41510689e-03)*64
        dc  (0.43289259e-03)*64
        dc  (0.44851832e-03)*64
        dc  (0.46512939e-03)*64
        dc  (0.47946570e-03)*64
        dc  (0.49457222e-03)*64
        dc  (0.50729653e-03)*64
        dc  (0.52087777e-03)*64
        dc  (0.53188344e-03)*64
        dc  (0.54364139e-03)*64
        dc  (0.55291411e-03)*64
        dc  (0.56262314e-03)*64
        dc  (0.56979991e-03)*64
        dc  (0.57740766e-03)*64
        dc  (0.58243563e-03)*64
        dc  (0.58781682e-03)*64
        dc  (0.59047760e-03)*64
        dc  (0.59344829e-03)*64
        dc  (0.59372943e-03)*64
        dc  (0.59428613e-03)*64
        dc  (0.59198041e-03)*64
        dc  (0.58991893e-03)*64
        dc  (0.58507849e-03)*64
        dc  (0.58031385e-03)*64
        dc  (0.57286571e-03)*64
        dc  (0.56550244e-03)*64
        dc  (0.55534288e-03)*64
        dc  (0.54528180e-03)*64
        dc  (0.53243048e-03)*64
        dc  (0.51973539e-03)*64
        dc  (0.50425751e-03)*64
        dc  (0.48889371e-03)*64
        dc  (0.47077367e-03)*64
        dc  (0.45288575e-03)*64
        dc  (0.43231284e-03)*64
        dc  (0.41188824e-03)*64
        dc  (0.38891030e-03)*64
        dc  (0.36613410e-03)*64
        dc  (0.34080609e-03)*64
        dc  (0.31585642e-03)*64
        dc  (0.28841663e-03)*64
        dc  (0.26142411e-03)*64
        dc  (0.23201830e-03)*64
        dc  (0.20315731e-03)*64
        dc  (0.17204252e-03)*64
        dc  (0.14157803e-03)*64
        dc  (0.10892609e-03)*64
        dc  (0.77015720e-04)*64
        dc  (0.43157954e-04)*64
        dc  (0.10158401e-04)*64
        dc (-0.24711946e-04)*64
        dc (-0.58508478e-04)*64
        dc (-0.94085000e-04)*64
        dc (-0.12843823e-03)*64
        dc (-0.16437517e-03)*64
        dc (-0.19893982e-03)*64
        dc (-0.23490912e-03)*64
        dc (-0.26938017e-03)*64
        dc (-0.30507986e-03)*64
        dc (-0.33907755e-03)*64
        dc (-0.37410390e-03)*64
        dc (-0.40733267e-03)*64
        dc (-0.44143212e-03)*64
        dc (-0.47347276e-03)*64
        dc (-0.50624856e-03)*64
        dc (-0.53678988e-03)*64
        dc (-0.56786137e-03)*64
        dc (-0.59657684e-03)*64
        dc (-0.62562176e-03)*64
        dc (-0.65215549e-03)*64
        dc (-0.67882810e-03)*64
        dc (-0.70282747e-03)*64
        dc (-0.72682160e-03)*64
        dc (-0.74800372e-03)*64
        dc (-0.76897524e-03)*64
        dc (-0.78695838e-03)*64
        dc (-0.80465956e-03)*64
        dc (-0.81923220e-03)*64
        dc (-0.83334127e-03)*64
        dc (-0.84423716e-03)*64
        dc (-0.85450313e-03)*64
        dc (-0.86146872e-03)*64
        dc (-0.86769415e-03)*64
        dc (-0.87052397e-03)*64
        dc (-0.87252399e-03)*64
        dc (-0.87104028e-03)*64
        dc (-0.86864096e-03)*64
        dc (-0.86272566e-03)*64
        dc (-0.85585972e-03)*64
        dc (-0.84538711e-03)*64
        dc (-0.83390297e-03)*64
        dc (-0.81885874e-03)*64
        dc (-0.80275384e-03)*64
        dc (-0.78310817e-03)*64
        dc (-0.76239882e-03)*64
        dc (-0.73815871e-03)*64
        dc (-0.71289705e-03)*64
        dc (-0.68414654e-03)*64
        dc (-0.65442431e-03)*64
        dc (-0.62128925e-03)*64
        dc (-0.58723963e-03)*64
        dc (-0.54985762e-03)*64
        dc (-0.51168317e-03)*64
        dc (-0.47032558e-03)*64
        dc (-0.42822771e-03)*64
        dc (-0.38309651e-03)*64
        dc (-0.33737882e-03)*64
        dc (-0.28878031e-03)*64
        dc (-0.23977412e-03)*64
        dc (-0.18804963e-03)*64
        dc (-0.13610022e-03)*64
        dc (-0.81644161e-04)*64
        dc (-0.27155271e-04)*64
        dc  (0.29612100e-04)*64
        dc  (0.86188549e-04)*64
        dc  (0.14481507e-03)*64
        dc  (0.20304578e-03)*64
        dc  (0.26302342e-03)*64
        dc  (0.32234541e-03)*64
        dc  (0.38318080e-03)*64
        dc  (0.44308510e-03)*64
        dc  (0.50423131e-03)*64
        dc  (0.56415948e-03)*64
        dc  (0.62502909e-03)*64
        dc  (0.68441778e-03)*64
        dc  (0.74443873e-03)*64
        dc  (0.80268946e-03)*64
        dc  (0.86126802e-03)*64
        dc  (0.91778301e-03)*64
        dc  (0.97429589e-03)*64
        dc  (0.10284780e-02)*64
        dc  (0.10823718e-02)*64
        dc  (0.11336011e-02)*64
        dc  (0.11842394e-02)*64
        dc  (0.12319314e-02)*64
        dc  (0.12787338e-02)*64
        dc  (0.13223225e-02)*64
        dc  (0.13647035e-02)*64
        dc  (0.14036074e-02)*64
        dc  (0.14410298e-02)*64
        dc  (0.14747176e-02)*64
        dc  (0.15066492e-02)*64
        dc  (0.15346139e-02)*64
        dc  (0.15605631e-02)*64
        dc  (0.15822994e-02)*64
        dc  (0.16018213e-02)*64
        dc  (0.16169356e-02)*64
        dc  (0.16296053e-02)*64
        dc  (0.16376962e-02)*64
        dc  (0.16431451e-02)*64
        dc  (0.16438850e-02)*64
        dc  (0.16418264e-02)*64
        dc  (0.16349220e-02)*64
        dc  (0.16250921e-02)*64
        dc  (0.16103341e-02)*64
        dc  (0.15925550e-02)*64
        dc  (0.15697879e-02)*64
        dc  (0.15439534e-02)*64
        dc  (0.15130882e-02)*64
        dc  (0.14791138e-02)*64
        dc  (0.14401501e-02)*64
        dc  (0.13980801e-02)*64
        dc  (0.13510756e-02)*64
        dc  (0.13010016e-02)*64
        dc  (0.12460739e-02)*64
        dc  (0.11881810e-02)*64
        dc  (0.11255594e-02)*64
        dc  (0.10600865e-02)*64
        dc  (0.99004735e-03)*64
        dc  (0.91732782e-03)*64
        dc  (0.84023969e-03)*64
        dc  (0.76067843e-03)*64
        dc  (0.67700900e-03)*64
        dc  (0.59107936e-03)*64
        dc  (0.50132256e-03)*64
        dc  (0.40959055e-03)*64
        dc  (0.31435001e-03)*64
        dc  (0.21745660e-03)*64
        dc  (0.11738786e-03)*64
        dc  (0.16014325e-04)*64
        dc (-0.88134548e-04)*64
        dc (-0.19320543e-03)*64
        dc (-0.30064420e-03)*64
        dc (-0.40859554e-03)*64
        dc (-0.51846297e-03)*64
        dc (-0.62841875e-03)*64
        dc (-0.73979958e-03)*64
        dc (-0.85079833e-03)*64
        dc (-0.96274167e-03)*64
        dc (-0.10738135e-02)*64
        dc (-0.11853189e-02)*64
        dc (-0.12954350e-02)*64
        dc (-0.14054461e-02)*64
        dc (-0.15135652e-02)*64
        dc (-0.16210321e-02)*64
        dc (-0.17260656e-02)*64
        dc (-0.18298825e-02)*64
        dc (-0.19307379e-02)*64
        dc (-0.20298075e-02)*64
        dc (-0.21253792e-02)*64
        dc (-0.22186099e-02)*64
        dc (-0.23077838e-02)*64
        dc (-0.23940583e-02)*64
        dc (-0.24757397e-02)*64
        dc (-0.25539713e-02)*64
        dc (-0.26270912e-02)*64
        dc (-0.26962012e-02)*64
        dc (-0.27596864e-02)*64
        dc (-0.28186440e-02)*64
        dc (-0.28714908e-02)*64
        dc (-0.29192930e-02)*64
        dc (-0.29605085e-02)*64
        dc (-0.29962000e-02)*64
        dc (-0.30248540e-02)*64
        dc (-0.30475424e-02)*64
        dc (-0.30627795e-02)*64
        dc (-0.30716234e-02)*64
        dc (-0.30726404e-02)*64
        dc (-0.30668718e-02)*64
        dc (-0.30529497e-02)*64
        dc (-0.30318995e-02)*64
        dc (-0.30023870e-02)*64
        dc (-0.29654417e-02)*64
        dc (-0.29197922e-02)*64
        dc (-0.28664640e-02)*64
        dc (-0.28042200e-02)*64
        dc (-0.27340979e-02)*64
        dc (-0.26549008e-02)*64
        dc (-0.25676715e-02)*64
        dc (-0.24712819e-02)*64
        dc (-0.23667570e-02)*64
        dc (-0.22530330e-02)*64
        dc (-0.21311275e-02)*64
        dc (-0.20000334e-02)*64
        dc (-0.18607877e-02)*64
        dc (-0.17124281e-02)*64
        dc (-0.15559847e-02)*64
        dc (-0.13905510e-02)*64
        dc (-0.12171792e-02)*64
        dc (-0.10350102e-02)*64
        dc (-0.84509864e-03)*64
        dc (-0.64664474e-03)*64
        dc (-0.44068997e-03)*64
        dc (-0.22650836e-03)*64
        dc (-0.51413663e-05)*64
        dc  (0.22408576e-03)*64
        dc  (0.46012376e-03)*64
        dc  (0.70360943e-03)*64
        dc  (0.95347967e-03)*64
        dc  (0.12103100e-02)*64
        dc  (0.14730396e-02)*64
        dc  (0.17422077e-02)*64
        dc  (0.20167516e-02)*64
        dc  (0.22971479e-02)*64
        dc  (0.25823445e-02)*64
        dc  (0.28727581e-02)*64
        dc  (0.31673517e-02)*64
        dc  (0.34665004e-02)*64
        dc  (0.37691598e-02)*64
        dc  (0.40756692e-02)*64
        dc  (0.43849815e-02)*64
        dc  (0.46974001e-02)*64
        dc  (0.50118971e-02)*64
        dc  (0.53287293e-02)*64
        dc  (0.56468714e-02)*64
        dc  (0.59665404e-02)*64
        dc  (0.62867431e-02)*64
        dc  (0.66076536e-02)*64
        dc  (0.69282991e-02)*64
        dc  (0.72488170e-02)*64
        dc  (0.75682439e-02)*64
        dc  (0.78867050e-02)*64
        dc  (0.82032531e-02)*64
        dc  (0.85179871e-02)*64
        dc  (0.88299848e-02)*64
        dc  (0.91393106e-02)*64
        dc  (0.94450805e-02)*64
        dc  (0.97473431e-02)*64
        dc  (0.10045246e-01)*64
        dc  (0.10338803e-01)*64
        dc  (0.10627200e-01)*64
        dc  (0.10910441e-01)*64
        dc  (0.11187748e-01)*64
        dc  (0.11459119e-01)*64
        dc  (0.11723799e-01)*64
        dc  (0.11981778e-01)*64
        dc  (0.12232352e-01)*64
        dc  (0.12475497e-01)*64
        dc  (0.12710564e-01)*64
        dc  (0.12937509e-01)*64
        dc  (0.13155730e-01)*64
        dc  (0.13365182e-01)*64
        dc  (0.13565321e-01)*64
        dc  (0.13756100e-01)*64
        dc  (0.13937014e-01)*64
        dc  (0.14108024e-01)*64
        dc  (0.14268671e-01)*64
        dc  (0.14418929e-01)*64
        dc  (0.14558398e-01)*64
        dc  (0.14687039e-01)*64
        dc  (0.14804520e-01)*64
        dc  (0.14910799e-01)*64
        dc  (0.15005609e-01)*64
        dc  (0.15088920e-01)*64
        dc  (0.15160518e-01)*64
        dc  (0.15220372e-01)*64
        dc  (0.15268330e-01)*64
        dc  (0.15304383e-01)*64
        dc  (0.15328432e-01)*64
        dc  (0.15340476e-01)*64


        ENDSEC
